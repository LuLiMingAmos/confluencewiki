AJS.toInit(function(c){var d=400;var b=250;Confluence.MoveBlogPostDialog=function(g){var i=AJS.Meta.get("page-title");g=c.extend({spaceKey:AJS.Meta.get("space-key"),spaceName:AJS.Meta.get("space-name"),title:AJS.I18n.getText("move.blogpost.dialog.title"),buttonName:AJS.I18n.getText("move.name"),moveHandler:function(j){AJS.debug("No move handler defined. Closing dialog.");j.remove()},cancelHandler:function(j){j.remove();return false}},g);var h=AJS.ConfluenceDialog({width:d,height:b,id:"move-blogpost-dialog"});h.addHeader(g.title);h.addPanel(AJS.I18n.getText("move.blogpost.dialog.panel.title"),Confluence.Templates.MoveBlogPost.dialogPanel(),"move-blogpost-dialog-panel","move-blogpost-dialog-panel-id");c("#new-space").auiSelect2(Confluence.UI.Components.SpacePicker.build());var e=function(k){var j=c("#new-space").val();g.moveHandler(k,j,f)};function f(j){c("#move-blogpost-dialog .move-errors").empty();AJS.messages.error("#move-blogpost-dialog .move-errors",{body:j,closeable:false})}h.addButton(g.buttonName,e,"move-button");h.addCancel(AJS.I18n.getText("cancel.name"),g.cancelHandler);h.show();return h};function a(j,f,g){j=j.popup.element;j.addClass("waiting");c("button",j).prop("disabled",true);var k=c("<div class='throbber'></div>");j.append(k);var i=Raphael.spinner(k[0],100,"#666");function h(l){g(l);j.removeClass("waiting");i();c("button",j).prop("disabled",false)}function e(l){AJS.trigger("analyticsEvent",{name:l,data:{newSpaceKey:f,oldSpaceKey:AJS.params.spaceKey,blogPostId:AJS.params.pageId}})}if(f===""){h(AJS.I18n.getText("move.blogpost.dialog.no.space.selected"));return}c.ajax({url:contextPath+"/pages/moveblogpost.action",type:"GET",dataType:"json",data:{blogPostId:AJS.params.pageId,spaceKey:f},error:function(){h(AJS.I18n.getText("move.blogpost.dialog.move.failed"));e("moveblogpost.ajaxError")},success:function(l){var m=[].concat(l.validationErrors||[]).concat(l.actionErrors||[]).concat(l.errorMessage||[]);if(m.length>0){h(m[0]);e("moveblogpost.serverValidationError");return}e("moveblogpost.success");window.location.href=contextPath+l.blogPost.url+(l.blogPost.url.indexOf("?")>=0?"&":"?")+"moved=true"}})}c("#action-move-blogpost-dialog-link").click(function(f){f.preventDefault();if(c("#move-blogpost-dialog").length>0){c("#move-blogpost-dialog, body > .shadow, body > .aui-blanket").remove()}new Confluence.MoveBlogPostDialog({moveHandler:a});return false})});